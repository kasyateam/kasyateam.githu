<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
  <link rel="stylesheet" href="http://kasyateam.github.io/m/kmp/style-1.css">
</head>

<body>
  <div class="main" id="main">
    <div class="header">
      <p class="header-text">HTML5</p>
      <a href="#" class="header-info">HTML5 Геолокация</a>
    </div>
 
<h1>
О геолокации в HTML5
</h1>

<p><b>Обратите внимание:</b> IE9+, Chrome, Firefox, Opera и Safari имеют поддержку данной технологии.</p>
<p>С помощью HTML5 геолокации Вы можете определить местоположение пользователя.</p>
<p>Так как информация о местоположении может нарушать конфиденциальность, прежде чем сервер сможет получить данную информацию пользователь должен явным образом подтвердить, что не имеет возражений на этот счет.</p>

<p><b>Обратите внимание:</b> координаты местоположения определяются более точно на мобильных устройствах, потому что они имеют свой собственный встроенный GPS приемник.</p>
<p>Местоположение пользователей на стационарных компьютерах определяется путем комбинированного анализа IP адреса самого компьютера и IP адресов окружающих WI-FI роутеров в радиусе покрытия которых компьютер находится в данный момент.</p>

<h1>
Использование геолокации в HTML5
</h1>

<p>Текущая позиция пользователя может быть определена с помощью метода <b>getCurrentPosition()</b> объекта <b>navigator.geolocation</b>.</p>

<pre style="font-size: 9px">
navigator.geolocation.getCurrentPosition(success_function, error_function, options);
</pre>

<p>- <b>success_function</b> - имя функции, которая будет вызвана в случае если координаты пользователя будут считаны удачно.</p>
<p>- <b>error_function</b> - имя функции, которая будет вызвана если при считывании координат произойдет ошибка.</p>
<p>- <b>options</b> - позволяет задать настройки, которые будут использованы при считывании координат. Возможные значения: <b>enableHighAccuracy</b> - если имеет значение true браузер будет пытаться определить местоположение как можно точнее; <b>timeout</b> - устанавливает максимально допустимое время, которое браузер может использовать для считывания данных (по умолчанию время считывания не ограничено); <b>maximumAge</b> - как долго браузер будет хранить к кэше предыдущее сохраненное значение.</p>

<p>В случае если пользователь разрешил использовать данные о его местоположении и они были удачно считаны браузером.</p>
<p>В функцию <b>success_function</b> в качестве параметра будет передан объект, который содержит свойство <b>timestamp</b> (содержит время считывание координат) и объект coords, который имеет следующие свойства:</p>

<table>
<tr>
<th>Событие</th>
<th>Описание</th>
</tr>
<tr>
<td>latitude и longitude</td>
<td>Широта и долгота местоположения пользователя</td>
</tr>
<tr>
<td>altitude</td>
<td>Высота от уровня моря в метрах</td>
</tr>
<tr>
<td>accuracy</td>
<td>Точность определения широты и долготы (чем больше число тем меньше точность)</td>
</tr>
<tr>
<td>altitudeAccuracy</td>
<td>Точность определения высоты (чем больше число тем меньше точность)</td>
</tr>
<tr>
<td>heading</td>
<td>Показывает направление пользователя в градусах (т.е. 0 градусов значит, что пользователь направляется на север, 180 на юг и т.д.).</td>
</tr>
<tr>
<td>speed</td>
<td>Скорость перемещения в метрах в секунду</td>
</tr>
</table>

<pre>
&lt;script>
function getCoordinates()
{
navigator.geolocation.getCurrentPosition(showCoordinates);
}

function showCoordinates(position)
{
document.write('Широта: ' + position.coords.latitude + "<br />");
document.write('Долгота: ' + position.coords.longitude); 
}
&lt;/script>
</pre>

<p>В случае если при считывании координат пользователя произошла какая-либо ошибка будет вызвана функция <b>error_function</b>.</p>
<p>Возможные ошибки при считывании координат:</p>

<table>
<tr>
<th>Ошибка</th>
<th>Описание</th>
</tr>
<tr>
<td>PERMISSION_DENIED</td>
<td>Пользователь запретил считывать информацию о его местоположении.</td>
</tr>
<tr>
<td>POSITION_UNAVAILABLE</td>
<td>Браузер не может определить местоположение пользователя.</td>
</tr>
<tr>
<td>TIMEOUT</td>
<td>Браузер не успел определить местоположение пользователя в выделенное ему время.</td>
</tr>
<tr>
<td>UNKNOWN_ERROR</td>
<td>Во время определения местоположения произошла неизвестная ошибка.</td>
</tr>
</table>

<h1 id="title">
Отслеживание изменения местоположения
</h1>

<p>С помощью метода <b>watchPosition()</b> Вы можете считывать данные о месте положения пользователя через определенные интервалы времени.</p>
<p>После запуска данный метод возвращает специальный индикатор, который может использоваться позднее для завершения считывания с помощью метода <b>clearWatch()</b>.</p>
<p><b>Обратите внимание:</b> чтобы увидеть как изменяются координаты во время перемещения мы рекомендуем тестировать данный пример на мобильных устройствах со встроенным GPS.</p>

<pre>
&lt;script>
function getCoordinates()
{
   watchID = navigator.geolocation.watchPosition(showCoordinates);
}

function stop()
{
   if (watchID)
   {
      navigator.geolocation.clearWatch(watchID);
      watchID = null;
   }
}
&lt;/script>
</pre>

<h1>
Поддержка старых браузеров
</h1>

<p>Проверить имеет ли браузер пользователя поддержку данной технологии или нет Вы можете с помощью следующей конструкции:</p>

<pre>
&lt;script>
if (navigator.geolocation)
{
   //Код для браузеров поддерживающих геолокацию
}
else
{
   //Код для браузеров неподдерживающих геолокацию
}
&lt;/script>
</pre>
</body>
</html>
